{{- if not .Values.secrets.existingSecret }}
apiVersion: v1
kind: Secret
metadata:
  name: {{ include "feature-flags-backend.fullname" . }}-secrets
  labels:
    {{- include "feature-flags-backend.labels" . | nindent 4 }}
type: Opaque
data:
  {{- if .Values.secrets.databaseUrl }}
  DATABASE_URL: {{ .Values.secrets.databaseUrl | b64enc | quote }}
  {{- else }}
  DATABASE_URL: {{ "postgresql://feature_flags:change_me@localhost:5432/feature_flags" | b64enc | quote }}
  {{- end }}
  {{- if .Values.secrets.apiKeys }}
  API_KEYS: {{ .Values.secrets.apiKeys | b64enc | quote }}
  {{- else }}
  API_KEYS: {{ "" | b64enc | quote }}
  {{- end }}
  {{- if .Values.secrets.encryptionPassword }}
  ENCRYPTION_PASSWORD: {{ .Values.secrets.encryptionPassword | b64enc | quote }}
  {{- else }}
  ENCRYPTION_PASSWORD: {{ "" | b64enc | quote }}
  {{- end }}
{{- end }}

