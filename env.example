# ═══════════════════════════════════════════════════════════════════════════════
# Feature Flags Backend — Пример конфигурации
# ═══════════════════════════════════════════════════════════════════════════════
#
# Скопируйте этот файл в .env и заполните значения:
#   cp env.example .env
#
# ═══════════════════════════════════════════════════════════════════════════════

# ───────────────────────────────────────────────────────────────────────────────
# База данных (ОБЯЗАТЕЛЬНО)
# ───────────────────────────────────────────────────────────────────────────────
# Формат: postgresql://USER:PASSWORD@HOST:PORT/DATABASE
#
# Локальная разработка:
DATABASE_URL="postgresql://flags:flags@localhost:5432/feature_flags"
#
# С шифрованием (Jasypt-style):
# DATABASE_URL="ENC(base64_encrypted_value)"

# ───────────────────────────────────────────────────────────────────────────────
# Сервер
# ───────────────────────────────────────────────────────────────────────────────
PORT=4000
NODE_ENV=development
LOG_LEVEL=debug

# ───────────────────────────────────────────────────────────────────────────────
# Аутентификация
# ───────────────────────────────────────────────────────────────────────────────
# Режимы:
#   - keycloak : Production — JWT аутентификация через Keycloak
#   - dev      : Development — заголовки x-user-id, x-user-roles
#   - none     : Только для тестов — без аутентификации
#
AUTH_MODE=dev

# ───────────────────────────────────────────────────────────────────────────────
# API ключи для клиентских приложений
# ───────────────────────────────────────────────────────────────────────────────
# Список ключей через запятую для endpoint /evaluate
# Генерация: openssl rand -base64 32
#
API_KEYS=dev-api-key-1,dev-api-key-2

# ───────────────────────────────────────────────────────────────────────────────
# Keycloak (для AUTH_MODE=keycloak)
# ───────────────────────────────────────────────────────────────────────────────
KEYCLOAK_URL=http://localhost:8080
KEYCLOAK_REALM=FeatureFlags
KEYCLOAK_CLIENT_ID=feature-flags-api
KEYCLOAK_ADMIN_ROLE=feature-flags-admin

# ───────────────────────────────────────────────────────────────────────────────
# CORS
# ───────────────────────────────────────────────────────────────────────────────
# Разрешённые origins через запятую
CORS_ORIGINS=http://localhost:3000,http://localhost:5173

# ───────────────────────────────────────────────────────────────────────────────
# Rate Limiting
# ───────────────────────────────────────────────────────────────────────────────
RATE_LIMIT_WINDOW_MS=60000
RATE_LIMIT_MAX_REQUESTS=100
RATE_LIMIT_EVALUATE_MAX=200
RATE_LIMIT_MUTATION_MAX=20

# ───────────────────────────────────────────────────────────────────────────────
# Шифрование секретов (аналог Jasypt)
# ───────────────────────────────────────────────────────────────────────────────
# Мастер-пароль для расшифровки ENC(...) значений
# Если не используете шифрование — оставьте пустым
#
# ENCRYPTION_PASSWORD=your-master-password
#
# Команды CLI:
#   npm run secrets:encrypt "value" "password"
#   npm run secrets:decrypt "ENC(...)" "password"
#   npm run secrets:verify "ENC(...)" "password"

